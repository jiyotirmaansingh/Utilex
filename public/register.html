<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://cdn.tailwindcss.com https://cdn.socket.io https://cdn.jsdelivr.net https://cdnjs.cloudflare.com 'unsafe-inline' 'unsafe-eval'; connect-src 'self' http://localhost:8080 ws://localhost:8080 http://127.0.0.1:5500; img-src 'self' data: http://127.0.0.1:5500 https:; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com; font-src 'self' https://cdnjs.cloudflare.com; frame-ancestors 'self'; base-uri 'self';">
  <title>Register | Utilex</title>

  <!-- TailwindCSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- SweetAlert -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <style>
    body {
      background-color: #000300;
    }

    .glass {
      background: rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    input {
      border-radius: 8px;
    }

    button {
      border-radius: 8px;
    }

    html {
      scroll-behavior: smooth;
    }
  </style>
</head>

<body class="min-h-screen flex flex-col font-inter text-gray-100">

  <!-- ðŸ” Navbar -->
  <nav class="glass px-6 py-4 flex justify-between items-center border-b border-white/10">
    <a href="/index.html" class="text-2xl font-bold text-green-400 tracking-wide">Utilex</a>
  </nav>

  <!-- ðŸ§¾ Centered Register Form -->
  <div class="flex-grow flex justify-center items-center px-4">
    <form id="registerForm"
      class="glass p-8 rounded-lg shadow-2xl w-full max-w-md space-y-5 border border-white/10 text-gray-200">
      <h2 class="text-3xl font-semibold text-center text-green-400">Register</h2>

      <input required type="text" placeholder="Name" id="name"
        class="w-full p-3 bg-white/10 border border-white/20 text-gray-100 placeholder-gray-400 focus:ring-2 focus:ring-green-500 outline-none" />

      <input required type="email" placeholder="Email" id="email"
        class="w-full p-3 bg-white/10 border border-white/20 text-gray-100 placeholder-gray-400 focus:ring-2 focus:ring-green-500 outline-none" />

      <input required type="password" placeholder="Password" id="password"
        class="w-full p-3 bg-white/10 border border-white/20 text-gray-100 placeholder-gray-400 focus:ring-2 focus:ring-green-500 outline-none" />

      <button type="submit"
        class="w-full bg-green-600 hover:bg-green-700 text-white py-3 font-semibold transition-all duration-300">
        Register
      </button>

      <p class="text-sm text-center text-gray-400">
        Already have an account?
        <a href="/login.html" class="text-green-400 hover:underline">Login</a>
      </p>
    </form>
  </div>

  <!-- âœ… Registration Logic -->
  <script>
    document.getElementById("registerForm").addEventListener("submit", async (e) => {
      e.preventDefault();

      const name = document.getElementById("name").value.trim();
      const email = document.getElementById("email").value.trim();
      const password = document.getElementById("password").value;

      try {
        const res = await fetch("/api/user/register", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ name, email, password })
        });

        const responseText = await res.text();

        if (res.ok) {
          Swal.fire({
            icon: 'success',
            title: 'Registered successfully!',
            text: 'You can now log in.',
            confirmButtonText: 'Go to Login',
            confirmButtonColor: '#22c55e',
            background: '#0b0b0b',
            color: '#e5e5e5'
          }).then(() => {
            window.location.href = "/login.html";
          });
        } else {
          Swal.fire({
            icon: 'error',
            title: 'Registration Failed',
            text: responseText || 'Please try again.',
            confirmButtonColor: '#ef4444',
            background: '#0b0b0b',
            color: '#e5e5e5'
          });
        }
      } catch (error) {
        Swal.fire({
          icon: 'error',
          title: 'Server Error',
          text: 'Unable to connect. Try again later.',
          confirmButtonColor: '#ef4444',
          background: '#0b0b0b',
          color: '#e5e5e5'
        });
      }
    });
  </script>

</body>
</html>
